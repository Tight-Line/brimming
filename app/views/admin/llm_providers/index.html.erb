<% content_for(:title) { "LLM Providers - Admin - Brimming" } %>

<div class="admin-container">
  <div class="page-header">
    <h1>LLM Providers</h1>
    <div class="dropdown">
      <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
        Add Provider
      </button>
      <div class="dropdown-menu">
        <% LlmProvider::PROVIDER_TYPES.each do |provider_type| %>
          <%= link_to LlmProvider.new(provider_type: provider_type).display_provider_type,
                      new_admin_llm_provider_path(provider_type: provider_type),
                      class: "dropdown-item" %>
        <% end %>
      </div>
    </div>
  </div>

  <div class="alert alert-info">
    <strong>About LLM Providers:</strong>
    LLM providers power the Q&A Wizard for generating FAQ content.
    Multiple providers can be enabled simultaneously. One provider is marked as the default.
  </div>

  <% if @llm_providers.any? %>
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Provider</th>
          <th>Model</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @llm_providers.each do |provider| %>
          <tr>
            <td><%= link_to provider.name, admin_llm_provider_path(provider) %></td>
            <td><%= provider.display_provider_type %></td>
            <td><code><%= provider.llm_model %></code></td>
            <td>
              <% if provider.is_default? %>
                <span class="badge badge-success">Default</span>
              <% elsif provider.enabled? %>
                <span class="badge badge-info">Enabled</span>
              <% else %>
                <span class="badge badge-secondary">Disabled</span>
              <% end %>
            </td>
            <td class="actions-cell">
              <% if provider.enabled? && !provider.is_default? %>
                <%= button_to "★",
                              set_default_admin_llm_provider_path(provider),
                              method: :post,
                              class: "action-icon action-star",
                              title: "Set as default" %>
              <% end %>
              <% unless provider.is_default? %>
                <%= button_to provider.enabled? ? "○" : "●",
                              activate_admin_llm_provider_path(provider),
                              method: :post,
                              class: "action-icon action-toggle",
                              title: provider.enabled? ? "Disable" : "Enable" %>
              <% end %>
              <%= link_to "✎", edit_admin_llm_provider_path(provider), class: "action-icon action-edit", title: "Edit" %>
              <% if provider.can_delete? %>
                <%= button_to "✕", admin_llm_provider_path(provider),
                              method: :delete,
                              class: "action-icon action-delete",
                              title: "Delete",
                              data: { turbo_confirm: "Are you sure you want to delete this LLM provider?" } %>
              <% else %>
                <span class="action-icon action-disabled" title="Cannot delete enabled provider">✕</span>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="empty-state">
      <p>No LLM providers configured yet.</p>
      <p>LLM providers enable the Q&A Wizard to generate FAQ content from your articles and documentation.</p>
      <p><strong>Recommended:</strong> Start with OpenAI's GPT-4o for best results, or use Ollama for self-hosted models.</p>
    </div>
  <% end %>
</div>

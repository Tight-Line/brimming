<% content_for(:title) { "#{@space.name} - Brimming" } %>

<div class="space-header">
  <div class="space-title-row">
    <h1><%= @space.name %></h1>
    <% if policy(@space).update? || policy(@space).manage_moderators? %>
      <div class="admin-actions">
        <% if policy(@space).update? %>
          <%= link_to "Edit", edit_space_path(@space), class: "btn btn-small btn-secondary" %>
        <% end %>
        <% if policy(@space).manage_moderators? %>
          <%= link_to "Moderators", moderators_space_path(@space), class: "btn btn-small btn-secondary" %>
        <% end %>
        <% if policy(@space).destroy? %>
          <%= button_to "Delete", space_path(@space), method: :delete,
              class: "btn btn-small btn-danger",
              data: { turbo_confirm: "Are you sure you want to delete this space?" } %>
        <% end %>
      </div>
    <% end %>
  </div>
  <% if @space.description.present? %>
    <p class="space-description"><%= @space.description %></p>
  <% end %>
  <% if current_user&.subscribed_spaces&.include?(@space) %>
    <span class="badge badge-subscribed">You are subscribed</span>
  <% end %>
</div>

<div class="card">
  <div class="card-header">
    <h2>Questions (<%= @questions.count %>)</h2>
  </div>

  <% if @questions.any? %>
    <ul class="question-list">
      <% @questions.each do |question| %>
        <li class="question-item">
          <div class="question-title">
            <%= link_to question.title, question_path(question) %>
          </div>
          <div class="question-meta">
            <span>by <%= render 'shared/user_badge', user: question.author %></span>
            <span><%= question.answers_count %> answers</span>
            <% if question.has_correct_answer? %>
              <span class="badge badge-success">Solved</span>
            <% end %>
          </div>
        </li>
      <% end %>
    </ul>
  <% else %>
    <div class="empty-state">
      <p>No questions in this space yet.</p>
    </div>
  <% end %>
</div>

<% content_for(:title) { "Spaces - Brimming" } %>

<div class="page-header">
  <h1>Spaces</h1>
  <% if policy(Space).create? %>
    <div class="page-actions">
      <%= link_to "Create Space", new_space_path, class: "btn btn-primary" %>
    </div>
  <% end %>
</div>

<div class="card">
  <% if @spaces.any? %>
    <ul class="space-list">
      <% @spaces.each do |space| %>
        <li class="space-item">
          <div>
            <span class="space-name">
              <% if current_user&.subscribed_to?(space) %><span class="subscribed-icon" title="Subscribed">&#9733;</span> <% end %><%= link_to space.name, space_path(space) %>
            </span>
            <% if space.description.present? %>
              <p class="text-muted text-small mb-0"><%= truncate(space.description, length: 100) %></p>
            <% end %>
          </div>
          <span class="space-count">
            <%= space.questions_count %> questions
            <% if space.articles_count_value.to_i > 0 %>
              &middot; <%= space.articles_count_value %> <%= "article".pluralize(space.articles_count_value) %>
            <% end %>
          </span>
        </li>
      <% end %>
    </ul>
  <% else %>
    <div class="empty-state">
      <p>No spaces yet.</p>
    </div>
  <% end %>
</div>
